(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{1866:function(t,e,r){"use strict";r.d(e,"d",(function(){return u})),r.d(e,"b",(function(){return d})),r.d(e,"a",(function(){return h})),r.d(e,"e",(function(){return y})),r.d(e,"c",(function(){return b}));r(14),r(17),r(25),r(24),r(19),r(12),r(18);var n=r(8),i=r(5),a=(r(47),r(30),r(29)),o=r(38);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){Object(n["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t){return c.apply(this,arguments)}function c(){return(c=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,n,i,s,u,c,d,p;return regeneratorRuntime.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:return r=e.app,n=e.store,i=e.formattedParams,s=e.locale,t.prev=1,u=Object(o["k"])({formattedParams:i,locale:s,perPage:a["k"]}),c=l(l({},u),{},{keyType:"illustrations"}),t.next=6,n.dispatch("cache/get",{key:c});case 6:if(!(d=t.sent)){t.next=9;break}return t.abrupt("return",l({},d));case 9:return t.next=11,r.$illustrationsRepository.index(u);case 11:return p=t.sent,n.dispatch("cache/set",{key:c,value:p}),t.abrupt("return",l({},p));case 16:return t.prev=16,t.t0=t["catch"](1),console.error(t.t0),t.abrupt("return",{illustrations:[],total:0});case 20:case"end":return t.stop()}}),t,null,[[1,16]])})))).apply(this,arguments)}function d(t){return p.apply(this,arguments)}function p(){return(p=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,n,i,a,o,s,u;return regeneratorRuntime.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:return r=e.id,n=e.locale,i=e.store,a=e.app,o={locale:n,id:r},t.prev=2,t.next=5,i.dispatch("cache/get",{key:l(l({},o),{},{keyType:"illustration"})});case 5:if(!(s=t.sent)){t.next=8;break}return t.abrupt("return",l({},s));case 8:return t.next=10,a.$illustrationsRepository.show(r,o);case 10:return u=t.sent,i.dispatch("cache/set",{key:l(l({},o),{},{keyType:"illustration"}),value:u}),t.abrupt("return",u);case 15:t.prev=15,t.t0=t["catch"](2),console.error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[2,15]])})))).apply(this,arguments)}function h(t){return f.apply(this,arguments)}function f(){return(f=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,n,i,o,s,u;return regeneratorRuntime.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:return r=e.app,n=e.store,i=[],o={previews_count:a["c"]},t.prev=3,t.next=6,n.dispatch("cache/get",{key:l(l({},o),{},{keyType:"events-previews"})});case 6:if(!(s=t.sent)){t.next=11;break}u=s,t.next=15;break;case 11:return t.next=13,r.$eventsRepository.index(o);case 13:u=t.sent,n.dispatch("cache/set",{key:l(l({},o),{},{keyType:"events-previews"}),value:u});case 15:i=u.events.map((function(t){return{icon:"",isEvent:!0,prettyId:t.pretty_id,previews:t.previews||[],title:t.title,total:t.total}})),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](3),console.error(t.t0);case 21:return t.abrupt("return",i);case 22:case"end":return t.stop()}}),t,null,[[3,18]])})))).apply(this,arguments)}var v={illustrations:[],total:0};function y(t){return g.apply(this,arguments)}function g(){return(g=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,n,i,o,s,u,c,d,p,h,f,y,g;return regeneratorRuntime.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:if(r=e.app,n=e.store,i=e.page,o=void 0===i?1:i,s=e.locale,u=e.perPage,c=void 0===u?a["C"]:u,d=e.stylePrettyId,p=e.illustrationId,d){t.next=3;break}return t.abrupt("return",v);case 3:return f=l(l({},h={page:o,per_page:c,style_pretty_ids:d,locale:s}),{},{id:p,type:"similars"}),t.prev=5,t.next=8,n.dispatch("cache/get",{key:f});case 8:if(!(y=t.sent)){t.next=11;break}return t.abrupt("return",l({},y));case 11:return t.next=13,r.$illustrationsRepository.show(p,h,"similars");case 13:return g=t.sent,n.dispatch("cache/set",{key:f,value:g}),t.abrupt("return",g);case 18:return t.prev=18,t.t0=t["catch"](5),console.log(t.t0),t.abrupt("return",v);case 22:case"end":return t.stop()}}),t,null,[[5,18]])})))).apply(this,arguments)}var m={categories:[],total:0};function b(t){return w.apply(this,arguments)}function w(){return(w=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,n,i,o,s,u,c,d,p,h,f,v;return regeneratorRuntime.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:if(r=e.app,n=e.store,i=e.page,o=void 0===i?1:i,s=e.perPage,u=void 0===s?a["z"]:s,c=e.locale,d=e.illustrationId){t.next=3;break}return t.abrupt("return",m);case 3:return h=l(l({},p={related_illustration_id:d,page:o,per_page:u,random_previews_count:4,locale:c}),{},{keyType:"illustration-related-categories"}),t.prev=5,t.next=8,n.dispatch("cache/get",{key:h});case 8:if(!(f=t.sent)){t.next=11;break}return t.abrupt("return",l({},f));case 11:return t.next=13,r.$categoriesPreviewsRepository.index(p);case 13:return v=t.sent,n.dispatch("cache/set",{key:h,value:v}),t.abrupt("return",l({},v));case 18:return t.prev=18,t.t0=t["catch"](5),console.log(t.t0),t.abrupt("return",m);case 22:case"end":return t.stop()}}),t,null,[[5,18]])})))).apply(this,arguments)}},1941:function(t,e,r){var n=r(2080);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,r(10).default)("6875125c",n,!0,{sourceMap:!1})},1942:function(t,e,r){var n=r(2082);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,r(10).default)("199813b0",n,!0,{sourceMap:!1})},2079:function(t,e,r){"use strict";r(1941)},2080:function(t,e,r){var n=r(9)((function(t){return t[1]}));n.push([t.i,".illustration-modal{max-width:1144px;width:100%}.illustration-modal>.modal-close{right:-60px;top:16px}@media(max-width:1300px){.illustration-modal>.modal-close{left:10px;top:10px!important}}@media(max-width:400px){.illustration-modal>.modal-close{height:32px;width:32px}}",""]),n.locals={},t.exports=n},2081:function(t,e,r){"use strict";r(1942)},2082:function(t,e,r){var n=r(9)((function(t){return t[1]}));n.push([t.i,".body[data-v-a1af0a8e]{background-color:#fff;max-height:100%;position:relative;width:100%}@media(max-width:550px){.body[data-v-a1af0a8e]{order:2;width:100%}}@media(min-width:1144px){.i8-scroll[data-v-a1af0a8e]>.full-illustration{box-shadow:0 0 1px #6060604f,0 12px 24px -6px #60606026;position:relative}}.i8-scroll[data-v-a1af0a8e]::-webkit-scrollbar{display:none}",""]),n.locals={},t.exports=n},2198:function(t,e,r){"use strict";r.r(e);r(14),r(17),r(25),r(24),r(19),r(12),r(18);var n=r(5),i=r(8),a=(r(22),r(30),r(15)),o=r(353),s=r(1866);function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){Object(i["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var c={name:"OuchIllustrationModal",data:function(){return{gettingRelatedCategories:!1,gettingSameStyleIllustrations:!1,hasFullInfo:!1,hasPrev:!1,hasNext:!1,illustration:null,illustrationsHistory:[],initialPath:null,initialTitle:"",isAnimated:!1,loading:!0,locale:this.$i18n.localeProperties.iso,relatedCategories:[],sameStyleIllustrations:[],scrollTop:0,thumbImage:null,totalSameStyle:0,totalRelatedCategories:0,windowHeight:0}},computed:u({},Object(a["e"])({modalActive:function(t){return t.modalActive},illustrationIndexOffset:function(t){return t.illustrationIndexOffset},userId:function(t){var e;return(null===(e=t.auth.user)||void 0===e?void 0:e.id)||""},windowWidth:function(t){return t.windowWidth}})),watch:{illustration:function(t){var e=this;t?this.$nextTick((function(){e.$refs.body&&(e.$refs.body.scrollTop=0)})):this.hideToast()}},created:function(){this.isMobile=Object(o["a"])()},methods:u(u({},Object(a["b"])(["setModalActive","setIllustrationIndexOffset","setIllustrationNavDirection"])),{},{hideToast:function(){var t=document.getElementsByClassName("toast-container");t.length&&(t[0].outerHTML="")},setKeyEvents:function(){window.addEventListener("keydown",this.keyHandler)},removeKeyEvents:function(){window.removeEventListener("keydown",this.keyHandler)},keyHandler:function(t){"ArrowLeft"===t.code&&this.hasPrev&&(this.setIllustrationNavDirection(-1),this.setIllustrationIndexOffset(this.illustrationIndexOffset-1)),"ArrowRight"===t.code&&this.hasNext&&(this.setIllustrationNavDirection(1),this.setIllustrationIndexOffset(this.illustrationIndexOffset+1))},scrollHandler:function(){this.scrollTop=this.$refs.body.scrollTop},modalShown:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var n,i,a,o,l;return regeneratorRuntime.wrap((function(r){for(;1;)switch(r.prev=r.next){case 0:if(e.thumbImage=null==t?void 0:t.thumb,e.setKeyEvents(),e.addScrollToIllustrationBody(),e.freezePageBody(),e.setAppHeight(!0),e.loading=!0,e.modalActive||(e.setModalActive(!0),e.initialPath=e.$route.fullPath,e.initialTitle=document.title),e.sameStyleIllustrations=[],e.relatedCategories=[],e.hasFullInfo=!1,t.illustration){r.next=12;break}return r.abrupt("return");case 12:return e.illustration=t.illustration,r.prev=13,r.next=16,Object(s["b"])({app:e,store:e.$store,locale:e.locale,id:e.illustration.id});case 16:e.illustration=r.sent,r.next=22;break;case 19:r.prev=19,r.t0=r["catch"](13),console.error(r.t0);case 22:return r.prev=22,e.hasFullInfo=!0,r.finish(22);case 25:o=t.hasPrev,l=t.hasNext,e.hasPrev=o,e.hasNext=l,e.updateHistoryState(t),document.title="".concat(t.illustration.heading," | Ouch"),null!==(n=e.illustration)&&void 0!==n&&null!==(i=n.styles)&&void 0!==i&&i.length&&null!==(a=e.illustration)&&void 0!==a&&a.id&&(e.getSimilars(),e.getRelatedCategories()),e.loading=!1;case 32:case"end":return r.stop()}}),r,null,[[13,19,22,25]])})))()},addScrollToIllustrationBody:function(){var t=this;this.$nextTick((function(){t.scrollTop=0,t.$refs.body&&t.$refs.body.addEventListener("scroll",t.scrollHandler)}))},freezePageBody:function(){document.body.classList.add("is-frozen"),this.isMobile||document.body.classList.add("is-frozen--desktop")},getSimilars:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,n,i;return regeneratorRuntime.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return t.gettingSameStyleIllustrations=!0,e.next=3,Object(s["e"])({app:t,illustrationId:t.illustration.id,store:t.$store,locale:t.locale,stylePrettyId:t.illustration.styles[0].pretty_id});case 3:r=e.sent,n=r.illustrations,i=r.total,t.sameStyleIllustrations=n,t.totalSameStyle=i,t.gettingSameStyleIllustrations=!1;case 9:case"end":return e.stop()}}),e)})))()},getRelatedCategories:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,n,i;return regeneratorRuntime.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return t.gettingRelatedCategories=!0,e.next=3,Object(s["c"])({app:t,store:t.$store,illustrationId:t.illustration.id});case 3:r=e.sent,n=r.categories,i=r.total,t.totalRelatedCategories=i,t.relatedCategories=n,t.gettingRelatedCategories=!1;case 9:case"end":return e.stop()}}),e)})))()},unFreezePageBody:function(){document.body.classList.remove("is-frozen"),document.body.classList.remove("is-frozen--desktop")},updateHistoryState:function(t){var e,r=t.popstate,n=void 0!==r&&r,i=t.illustration;if(null!=i&&i.pretty_id){n||this.illustrationsHistory.push(i);var a="/illustrations/illustration/".concat(i.pretty_id).concat(null!=i&&null!==(e=i.json)&&void 0!==e&&e.url&&this.isAnimated?"--animated":"");window.history.pushState({page:a,title:i.id,id:i.id},i.heading,a)}},onPopStateChange:function(t){var e=this;if(!this.modalActive)return!0;this.$nextTick((function(){var t,r,n;if(1===e.illustrationsHistory.length)return e.$ouchModal.hide("illustration");e.illustrationsHistory.pop();var i=e.illustrationsHistory[e.illustrationsHistory.length-1];e.$ouchModal.show("illustration",{popstate:!0,illustration:i,thumb:{maxWidth:null==i||null===(t=i.preview1x)||void 0===t?void 0:t.width,maxHeight:null==i||null===(r=i.preview1x)||void 0===r?void 0:r.height,url:null==i||null===(n=i.thumb1x)||void 0===n?void 0:n.url}})}))},modalHidden:function(){this.modalActive&&(this.unFreezePageBody(),this.setAppHeight(!1),this.removeKeyEvents(),this.setModalActive(!1),this.illustrationsHistory=[],this.sameStyleIllustrations=[],this.relatedCategories=[],this.illustration=null,this.hasPrev=!1,this.hasNext=!1,this.thumbImage=null,window.history.replaceState(null,null,this.initialPath),document.title=this.initialTitle,this.$refs.body&&this.$refs.body.removeEventListener("scroll",this.scrollHandler))},setAppHeight:function(t){if(!t||this.windowHeight!==window.innerHeight){this.windowHeight=window.innerHeight;var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"));var r=document.querySelector("html"),n=document.querySelector("body");r.style.height=t?"calc(var(--vh, 1vh) * 100)":"auto",n.style.height=t?"calc(var(--vh, 1vh) * 100)":"auto"}}}),mounted:function(){window.addEventListener("popstate",this.onPopStateChange)},beforeDestroy:function(){window.removeEventListener("popstate",this.onPopStateChange)}},d=(r(2079),r(2081),r(4)),p=Object(d["a"])(c,(function(){var t=this,e=t._self._c;return e("ouch-modal",{attrs:{"affect-scroll":"",name:"illustration",contentClass:"illustration-modal",scrollTop:t.scrollTop},on:{shown:t.modalShown,closed:t.modalHidden},scopedSlots:t._u([{key:"body",fn:function(){return[e("div",{ref:"body",staticClass:"i8-scroll"},[e("ouch-full-illustration",{attrs:{"content-loading":t.gettingSameStyleIllustrations||t.gettingRelatedCategories,"has-full-info":t.hasFullInfo,loading:t.loading,hasNext:t.hasNext,hasPrev:t.hasPrev,illustration:t.illustration,"related-styles":t.relatedCategories,"same-style-illustrations":t.sameStyleIllustrations,"thumb-image":t.thumbImage,"total-same-style":t.totalSameStyle,"total-related-styles":t.totalRelatedCategories},on:{"animation:change":function(e){t.isAnimated=e}}})],1)]},proxy:!0}])})}),[],!1,null,"a1af0a8e",null);e["default"]=p.exports}}]);